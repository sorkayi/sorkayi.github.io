<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>WebSocket DEMO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        ul,
        li {
            padding: 0;
            margin: 0;
            list-style: none;
        }
    </style>
    <!-- <script src="Scripts/jquery.min.js"></script> -->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
</head>
<body>
    <input id="ipt_keyin" />
</body>

<script>

let wsc;

$(document).ready(function()  {
    if ("WebSocket" in window) {
        // init the websocket client
        wsc = new WebSocket("wss://www.aeplus.com.tw:8011/notify");

        wsc.onopen = function () {
            console.log("connected");
            
            // wsc.send(JSON.stringify(aryData));

            // startHeartbeat();
        };
        wsc.onclose = function () {
            console.log("closed");
        };
        wsc.onmessage = function (e) {
            var data = e.data;
            if (data != 'heartbeat')  {
                $('Body').append('<p>' + data + '</p>');
            }
        };

        function startHeartbeat()  {
            setInterval(function()  {
                wsc.send('heartbeat');
            }, 1000);
        }
    }

    $('#ipt_keyin').keyup(function(evt)  {
        if (evt.keyCode == 13)  {
            wsc.send($('#ipt_keyin').val());
            $('#ipt_keyin').val('');
        }
    });
});
    
</script>
</html>
